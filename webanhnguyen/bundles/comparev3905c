jfpts.compare={compareScroll:undefined,compareContainer:"#compareSwiper",compareScroller:"#compareSwiperScroller",compareTable:".cp-table",compareHeader:"#cpProduct",compareItem:".cp-cell",urlData:"/Ajax/CompareProduct/GetCompareResult",compareOption:{eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1},init:function(){jfpts.compare.getData()},initScroll:function(){jfpts.compare.calculateWidth();jfpts.compare.compareScroll=new IScroll(jfpts.compare.compareContainer,jfpts.compare.compareOption);jfpts.compare.reCaculateSize()},refresh:function(){jfpts.compare.compareScroll.refresh();setTimeout(function(){jfpts.compare.calculateWidth()},150)},calculateWidth:function(){var t=$(jfpts.compare.compareContainer).width(),n=$(jfpts.compare.compareHeader+">"+jfpts.compare.compareItem).length;$(jfpts.compare.compareScroller).width(n*200)},reCaculateSize:function(){$.each($(jfpts.compare.compareContainer+" "+jfpts.compare.compareTable+'[id!="'+jfpts.compare.compareHeader.replace("#","")+'"]'),function(n,t){var o=$(t).find("span"),f=0,e,i,r,u;for($.each(o,function(n,t){f=parseInt($(t).attr("data-row"))>f?parseInt($(t).attr("data-row")):f}),e=0;e<=f;e++){for(i=$($(t).find('span[data-row="'+e+'"]')),r=0,u=0;u<i.length;u++)r=$($(i)[u]).height()>r?$($(i)[u]).height():r;$(i).height(r)}})},getData:function(){var n=window.location.search.replace("?",""),t=n.indexOf("&");t>-1&&(n=n.substring(0,t));$.get(jfpts.compare.urlData,{listName:n},function(n){$(".detail-compare.clearfix").html(n);$(".cp-remove").click(function(n){n.preventDefault();var i=$(this).find("a").attr("data-id"),t=$(this).find("a").attr("data-ascii");$(".compare"+i).remove();window.history.pushState(null,null,window.location.pathname+window.location.search.replace("-vs-"+t,"").replace(t,""));jfpts.compare.compareScroll=undefined;jfpts.compare.compareScroll!=undefined?jfpts.compare.refresh():jfpts.compare.initScroll()});$(".cp-order").click(function(n){n.preventDefault();var t=$(this).find("a").attr("data-id"),i=$(this).find("a").attr("data-variantid"),r=$(this).find("a").attr("data-money");jfpts.data.addOrder(t,i,null,0,1,r)})}).complete(function(){jfpts.compare.compareScroll=undefined;jfpts.compare.compareScroll!=undefined?jfpts.compare.refresh():jfpts.compare.initScroll()})},onResize:function(){$(window).bind("resize",function(){setTimeOut(function(){jfpts.compare.compareScroll.calculateWidth();jfpts.compare.refresh()},200)})}};$().ready(function(){jfpts.compare.init();$(document).on("keyup",".compare-search",function(){$keyword=$(this).val();typeof this.xhrComplete!="undefined"&&this.xhrComplete.abort();this.xhrComplete=$.get("/Ajax/SearchLucene/AutoComplete",{searchTerm:decodeURI($keyword),searchField:"NameProduct",searchDefault:""},function(n){n._searchResults==""?$(".form-result").html("<ul><li>Không tìm thấy<\/li><\/ul>"):($(".form-result").html("<ul><\/ul>"),$(".form-result").attr("class","form-result fsc frs"),$.each(n._searchResults,function(n,t){$(".form-result ul").append('<li data-id="'+t.ID+'" data-type="'+t.TypeNameAscii+'" data-ascii="'+t.NameAscii+'" >'+t.NameProduct+"<\/li>")}),$(".form-result ul li").click(function(){var r=$(this).data("id"),u=$(this).data("type");if($(".compare"+r).size()>0)$().toastmessage("showWarningToast","Sản phẩm đã có trong danh sách so sánh.");else{var n=window.location.search.replace("?",""),t=n.indexOf("&"),i=n.indexOf("-vs-");n=t>-1?n.substring(0,t)+"-vs-"+$(this).data("ascii")+n.substring(t):i>-1?n.substr(0,i)+"-vs-"+$(this).data("ascii")+n.substring(i):n+"-vs-"+$(this).data("ascii");window.history.pushState(null,null,window.location.pathname+"?"+n);jfpts.compare.getData()}}))}).complete(function(){$(".form-result").mCustomScrollbar({theme:"light"})})});$(document).on("mouseleave",".fsc",function(){$(".form-result ul").html("")})})