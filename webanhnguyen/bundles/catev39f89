function buildButtonViewmore(n,t,i){return'<div class="p-item cell-1 p-item-more" id="ViewmoreFilter"><div class="p-item-bound"><a class="p-more view-more" data-pagecurrent="'+n+'" data-nextpage="'+t+'" data-type="Hot" data-list="list-product-hot"><span><i style="font-size: 80px" class="icons p-more-icon"><\/i><label>Xem thêm <strong>'+i+"<\/strong> sản phẩm<\/label><\/span><\/a><\/div><\/div>"}function Fillter(){var n=$(".listfilternomal").map(function(){if($(this).find("li.active")&&$(this).find("li.active:first-child").index()!==0){var n=$(this).data("query")+"=",t=$(this).find("li.active").map(function(){return $(this).children().data("value")}).get().join();return n+t}}).get();return n.join("&")}function FillterAdvance(){var n=$(".listfilteradvance").map(function(){var n=$(this).find("input[type='radio']:checked");if(n&&n.data("value"))return $(this).data("query")+"="+n.data("value")}).get();return $(".listfilterorder li.active").children().data("value")&&n.push("sl="+$(".listfilterorder li.active").children().data("value")),n.join("&")}function FillterMobile(n){var t="";if(n.indexOf("?")<0)$(".mfpt-filter-ullv").each(function(){var n=$(this),i=n.find("input[type='radio']:checked");i.data("value")&&(t+="&"+n.data("query")+"="+i.data("value"))}),t=t?n+"?"+t.substr(1,t.length-1):n;else{var i="",r=n.split("?")[0],u=$.makeArray(n.substring(n.indexOf("?")+1).split("&"));$(".mfpt-filter-ullv").each(function(){var n=$(this),r=n.find("input[type='radio']:checked");i+=n.data("query");r.data("value")&&(t+="&"+n.data("query")+"="+r.data("value"))});$.each(u,function(n,r){var u=r.split("=");i&&i.indexOf(u[0])<0&&(t+="&"+r)});t=t?r+"?"+t.substr(1,t.length-1):r}return t}var category_products={masonry:null,masonryOption:{columnWidth:".grid-sizer",itemSelector:".p-item",percentPosition:!0},append:function(n){category_products.masonry.append(n).packery("appended",n).packery("layout")},init:function(){category_products.masonry=$("#category-products").packery(category_products.masonryOption)}},productItem={init:function(){productItem.controlClickItem()},controlClickItem:function(){$(document).on("click",".tablet .p-item,.mobile .p-item",function(){$(this).toggleClass("active")});$(".desktop .p-item").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$(".tablet .p-item,.mobile .p-item").hover(function(){},function(){$(this).removeClass("active")})}};$(document).ready(function(){var t=window.location.pathname.indexOf("/")!==-1&&window.location.pathname.split("/").length>2?"http://"+window.location.host+"/"+window.location.pathname.split("/")[1]:"http://"+window.location.host+window.location.pathname,i,n;category_products.init();productItem.init();$(".fshop-lprod-bnbclode").click(function(){$(".fshop-lprod-bnbot").hide(200)});$(".fshop-lfter-ilncao").click(function(){$(".fshop-lprod-fillter").toggleClass("tgopen")});$(".fshop-lfter-ifihe").click(function(){$(".fshop-lprod-fillter").toggleClass("tgfillopen")});var r=new Swiper(".fshop-lprod-swiper",{pagination:".fshop-lprod-swiper .swiper-pagination",paginationClickable:!0,spaceBetween:30,centeredSlides:!0,autoplay:2500,autoplayDisableOnInteraction:!1,nextButton:".swiper-btncate.swiper-button-next",prevButton:".swiper-btncate.swiper-button-prev",loop:!0}),u=new Swiper(".fshop-cate-swiper",{pagination:".fshop-cate-swiper .swiper-pagination",paginationClickable:!0,spaceBetween:0,centeredSlides:!0,autoplay:2500,autoplayDisableOnInteraction:!1}),f=new Swiper(".fshop-lpslnews-swiper",{spaceBetween:30,slidesPerView:1,centeredSlides:!0,autoplay:4e3,autoplayDisableOnInteraction:!1,direction:"vertical",loop:!0});$(".listfilternomal li").click(function(n){n.stopPropagation();$(this).hasClass("fshop-lfter-search-btn")||($(this).index()!==0?$(this).parent().find("li.active").length!==$(this).parent().find("li").length||$(this).hasClass("active")?($(this).parent().find("li.active:first-child").removeClass("active"),$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")):($(this).parent().find("li.active").removeClass("active"),$(this).parent().find("li:first-child").addClass("active")):($(this).parent().find("li.active").removeClass("active"),$(this).addClass("active")))});$(".listfilternomal .fshop-lfter-search-btn, #btnAdvFilter").click(function(){var n=Fillter(),i=FillterAdvance();n||i?!i&&/^hang-san-xuat=[^&#,]+$/.test(n)?window.location="/"+window.location.pathname.split("/")[1]+"/"+/hang-san-xuat=([^&#]+)$/.exec(n)[1]:window.location.replace(t+"?"+n+(n&&i?"&"+i:i)):window.location.replace(t)});$(".listfilterorder li").click(function(){$(".listfilterorder li.active").removeClass("active");$(this).addClass("active");$(".listfilternomal .fshop-lfter-search-btn, #btnAdvFilter").trigger("click")});$("#btnAdvFilterUnSelect").click(function(){$(".listfilteradvance input").removeAttr("checked");$(".filterEmtyrad").attr("checked",!0);$(".filterEmtyrad").trigger("click")});$("#btmMobileFilter").click(function(){var t=window.location.pathname.indexOf("/")>-1&&window.location.pathname.split("/").length>2?"http://"+window.location.host+"/"+window.location.pathname.split("/")[1]:window.location.href,n=FillterMobile(t);n&&(window.location.href=n)});i=$.makeArray(window.location.href.substring(window.location.href.indexOf("?")+1).split("&"));$(".fshop-lfter-ifihe>p>span").text(window.location.href.indexOf("?")<0?0:i.length);$(".listfilterorder").each(function(){var n=$(this),t=n.find("li.active").children().text();t.trim()!="Tất cả"&&n.parent().find("button").html("<b>"+t+"<\/b><span class='glyphicon glyphicon-menu-down'><\/span>")});n=0;$(".mfpt-filter-ullv").each(function(){var i=$(this),t=i.find("input[type='radio']:checked").parent().find("label").text();t.trim()!="Tất cả"&&t.trim()!="Mặc định"&&(i.parent().parent().find(".mfpt-fil-select").text(t),n=n+1,$(".fshop-lfter-ifihe>p>span").text(n))});$(".panel-default a").click(function(){var n=$(this);setTimeout(function(){$("html,body").animate({scrollTop:n.parent().offset().top-60},"slow")},400)});$(document).on("click",".view-more",function(n){var t=$("#category-products").attr("data-link"),u="",r,i,f;(u=t.indexOf("?")<0?t+"?trang="+$("#category-products").attr("data-page"):t.indexOf("trang")<0?t+"&trang="+$("#category-products").attr("data-page"):t.indexOf("?trang")<0?t.replace(/&trang=\d/i,"&trang="+$("#category-products").attr("data-page")):t.replace(/\?trang=\d/i,"?trang="+$("#category-products").attr("data-page")),r=parseInt($("#category-products").attr("data-page"))+1,$("#category-products").attr("data-page",r),n.preventDefault(),$(".p-item-more").hasClass("is-loading")!=!0)&&(i=$(this),$(".p-item-more").addClass("is-loading"),$(".p-item-more i").attr({"class":"glyphicon glyphicon-refresh glyphicon-refresh-animate",style:"font-size: 80px"}),f=$(".p-more").attr("data-current"),i.attr("data-isfilter")?$.get("/Ajax/FilterProduct/ViewMoreFilter",{currentRecord:i.attr("data-nextpage"),url:window.location.href},function(n){$("#ViewmoreFilter").remove();category_products.masonry.packery("layout");var t=$(n.content);category_products.append(t);parseInt(n.total)-parseInt(n.totalCurrent)>0?setTimeout(function(){category_products.append($(buildButtonViewmore(i.attr("data-nextpage"),parseInt(n.totalCurrent),parseInt(n.total)-parseInt(n.totalCurrent))));$(".view-more").attr("data-isfilter","true")},500):$("#ViewmoreFilter").remove();productItem.init()}):$.get("/Ajax/FilterProduct/ViewMore",{page:i.attr("data-nextpage"),typeView:i.attr("data-type"),url:window.location.href},function(n){$("#ViewmoreFilter").remove();category_products.masonry.packery("layout");var t=$(n.content);category_products.append(t);parseInt(n.total)-parseInt(n.totalCurrent)>0?setTimeout(function(){category_products.append($(buildButtonViewmore(i.attr("data-nextpage"),parseInt(n.totalCurrent),parseInt(n.total)-parseInt(n.totalCurrent))))},500):$("#ViewmoreFilter").remove();productItem.init()}))})})